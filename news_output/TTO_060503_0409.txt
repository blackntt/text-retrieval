 Xâm_nhập thế_giới hacker ( kỳ 2 ) : Truy_tìm
Chuyện không phải đùa khi kèm theo đó là một file chứa cấu_trúc thư_mục của một_số máy_chủ phục_vụ web đặt tại văn_phòng chính cùng_với yêu_cầu một_số tiền lớn để giữ im_lặng và không khai_thác dữ_liệu về khách_hàng của công_ty . Nhiệm_vụ của tôi là trả_lời cho được các câu_hỏi : Ai đã làm_gì ? Khi nào và như_thế_nào ?
Công_ty A . là một công_ty lớn có chi_nhánh trên toàn thế_giới với hàng ngàn nhân_viên . Chính_sách bảo_mật của công_ty A . rất tốt và được cập_nhật đều_đặn hàng tháng . Các nhân_viên IT của công_ty A cũng có nhiều kinh_nghiệm trong việc xử_lý các sự_cố trên hệ_thống mạng .
Để phục_vụ cho việc truy_cập dữ_liệu cho toàn_bộ các chi_nhánh trên khắp thế_giới , văn_phòng chính quyết_định sử_dụng hệ_thống VPN ( 1 ) để dễ quản_lý và có các chính_sách bảo_mật hợp_lý .
Một buổi_sáng thứ_hai đầu tuần như mọi ngày đầu tuần khác , P . - tổng_giám_đốc của công_ty A . , ngồi đọc các email từ đối_tác , cấp dưới , thông_tin phản_hồi của khách_hàng … Nhưng hôm_nay , TGĐ P . bị thu_hút bởi một email có tiêu_đề đẫm mùi giang_hồ “ Công_ty A - Sống hay Chết ? ” từ địa_chỉ email của giám_đốc phụ_trách kỹ_thuật với nội_dung thông_báo rằng toàn_bộ hệ_thống mạng của công_ty đã bị kiểm_soát .
Đáng ngạc_nhiên hơn là email gửi kèm một file chứa cấu_trúc thư_mục của một_số máy_chủ phục_vụ web đặt tại văn_phòng chính cùng_với yêu_cầu một_số tiền lớn để giữ im_lặng và không khai_thác dữ_liệu về khách_hàng của công_ty . Chẳng_những vậy , kẻ tống_tiền còn đồng_thời kèm theo một lời cảnh_cáo rằng không nên đụng gì tới các máy_chủ đã bị xâm_nhập nếu_không sẽ phải trả_giá đắt !
“ Một chuyện đừa ư ? Thế_này thì không_thể_nào đùa rồi ! ” , TGĐ P . tự_nhủ . Bốc điện_thoại , điện ngay cho GĐ kỹ_thuật M . và P . nhanh_chóng được xác_nhận rằng M . không hề gửi một email nào như_thế . Bộ_phận IT của công_ty nhanh_chóng bắt_tay vào việc và đưa ra giải_pháp cho tình_huống . Họ rút cable của máy_chủ tình_nghi bị xâm_nhập ra khỏi hệ_thống mạng nhưng lập_tức , màn_hình các máy_chủ này lập_tức xuất_hiện những hình hoạt_hình nhảy_múa và rồi tất_cả chỉ còn một màu đen ! Nhân_viên bộ_phận IT hốt_hoảng tắt máy và gọi điện cho tôi .
Chứng_cứ
Ngay chiều_hôm đó , tôi có_mặt tại “ hiện_trường ” xảy_ra “ vụ_án ” . “ Tổ_chức khá quy_mô và bài_bản ” , tôi tự_nhủ sau khi tiếp_cận với hệ_thống mạng của công_ty A . Hệ_thống mạng của công_ty này sử_dụng một Hardware_Firewall ( HF ) của CISCO có chức_năng VPN , một Proxy_Server kiêm luôn chức_năng làm Software_Firewall ( SF ) chạy trên nền Linux . Toàn_bộ hệ_thống được đặt sau Firewall ( tường lửa ) , biệt_lập hoàn_toàn với Internet và không chấp_nhận bất_cứ một kết_nối nào từ bên ngoài . Như_vậy các cuộc tấn_công từ ngoài vào sẽ được loại_bỏ ngay bởi HF . Tôi lập_tức đặt ra 2 giả_thuyết : 1 . Hệ_thống đã bị tấn_công từ bên trong bởi nhân_viên của công_ty ; 2 ) . HF có lỗi và bị khai_thác lỗi đó .
Theo cảm_tính và kinh_nghiệm làm_việc , tôi kiểm_tra ngay phần HF để có_thể loại_trừ bớt các trường_hợp ít có khả_năng xảy_ra . Đây là loại HF hiện_đại vào bậc nhất của CISCO vào thời_điểm hiện_tại . Firmware ( 2 ) của HF đã được cập_nhật phiên_bản mới nhất từ nhà_cung_cấp CISCO và tính tới thời_điểm cuộc tấn_công bị phát_hiện , vẫn chưa có một lỗi bảo_mật có_thể khai_thác nào về dòng HF này được nhà_cung_cấp cũng_như các website bugtraq thông_báo . Có_thể loại_bỏ trường_hợp bị tấn_công trực_tiếp từ bên ngoài ? Vẫn chưa có gì chắc_chắn cả !
Quay lại các máy_chủ đã bị “ chết ” , tôi ngán_ngẩm khi biết rằng toàn_bộ các máy_chủ đó đã bị xóa sạch_sẽ . Trên ổ_cứng của 3 máy_chủ chỉ còn lại một tập_tin 0wned . Cũng may là dữ_liệu khách_hàng của các máy này đã được sao lưu trên ổ băng_từ . Như_vậy là hiện_trường xảy_ra vụ_án đã bị phi_tang sạch_sẽ . Mọi cố_gắng phục_hồi dữ_liệu trở_nên vô_nghĩa khi ổ_cứng bị ghi đè lên một bảng FAT mới . Điều này cũng đồng_nghĩa với việc các đầu_mối để điều_tra cuộc tấn_công đã bị xóa sạch và cuộc điều_tra lại cuộc tấn_công của hacker được đưa vào một ngõ_cụt tối_tăm . Tôi kết_thúc một ngày mệt_mỏi với hàng trăm dòng syslog của HF và 3 cái máy_chủ đã bị xóa sạch ổ_cứng .
Lần theo dấu_vết
Ngày hôm_sau , sau đợt tổng kiểm_tra HF , tôi quay lại với manh_mối duy_nhất lúc đó là email đã được gửi tới tổng_giám_đốc của công_ty . Phân_tích email header và log của mail server , tôi nhận ra rằng email này được gửi từ IP 192.168.4.36 . Như_vậy giả_thuyết hệ_thống bị tấn_công từ bên trong có_vẻ khả_thi và rõ_ràng nhất nhưng công_ty có cả một hệ_thống mạng lớn với rất nhiều trạm làm_việc khắp_nơi trên thế_giới . Tôi yêu_cầu bộ_phận IT xác_định IP này thuộc chi_nhánh nào . Các thông_tin về IP 192.168.4.36 được nhanh_chóng thu_thập .
C : \ & gt ; nslookup
Default_Server : ns1.company.com
Address : 172.160.7.41
& gt ; 192.168.4.36
Server : ns1.company.com
Address : 172.160.7.41
Name : 192-168-4-36-tto.sales-vpn2.e-asia.company.com
Address : 192.168.4.36
Những thông_tin này khá hữu_ích . Nhờ nó mà tôi biết được email này được gửi từ chi_nhánh Y và chiếc máy sở_hữu địa_chỉ IP này chính là một máy trạm ( workstation ) làm_việc của nhân_viên K . - một nhân_viên làm_việc lâu năm trong công_ty . Máy_tính này sử_dụng hệ điều hình Windows 2000 Professional . Theo yêu_cầu của ban quản_lý , ổ_cứng của máy_tính này nhanh_chóng được tháo ra và chuyển tới văn_phòng chính .
Hai ngày_sau . Ổ_cứng của máy_tính từ chi_nhánh Y đã được chuyển tới . Tôi gắn nó vào một máy_tính độc_lập với mạng của công_ty A . và đăng_nhập với mật_khẩu của Administrator để bắt_đầu quá_trình kiểm_tra . Hệ_thống hoạt_động bình_thường . Các phần_mềm được cài_đặt đều là phần_mềm nằm trong quy_định của công_ty .
Mọi thứ không có gì bất_thường cả . Tuy_nhiên , mọi thứ bắt_đầu bất_thường khi tôi kiểm_tra tới các tài_khoản người dùng trên hệ_thống . Ngoài các tài_khoản Administrator , Guest , NVK ( vốn là tài_khoản của nhân_viên K . ) tôi đã tìm thấy một tài_khoản khác đó là tài_khoản 0wn . Tôi điện cho K . và được anh_ta xác_nhận rằng không hề cài thêm bất_cứ một account nào trên hệ_thống . Như_vậy tài_khoản 0wn là một account được tạo ra để lần sau đăng_nhập dễ_dàng hơn chăng ?
Tiếp_tục kiểm_tra các xử_lý ( process ) đang chạy trên hệ_thống , tôi tìm ra một process có cái tên hay tuyệt : system32.exe . Process này nằm ngay cạnh system 32.dll ( một tập_tin thư_viện động của hệ_thống ) . Phải công_nhận rằng tay hacker này cũng rất thông_minh khi đặt tên của backdoor ( 3 ) trùng tên với một tập_tin hệ_thống . Nó dễ_dàng đánh_lừa những người thiếu kinh_nghiệm và cả những người có kinh_nghiệm nhưng thiếu cẩn_thận . Bằng lệnh dir cùng khóa chuyển / s tôi nhanh_chóng xác_định được vị_trí của tập_tin system 32.exe . Nó được đặt tại 2 thư_mục là WIN2K/SYSTEM32 và WIN2K/SYSTEM32/DLLCACHE .
Uhm , system32.exe này là cái gì vậy nhỉ ? Tôi quyết_định chạy thử xem nó là cái gì . Sau một hồi loay_hoay với đủ các khóa chuyển , tôi xác_định được nó chính là netcat . Một công_cụ quen_thuộc của các quản_trị viên và cũng là một backdoor lợi_hại của những kẻ xâm_nhập . Nó như một chiếc đũa thần cho những kẻ xâm_nhập với hàng_loạt những chức_năng như kết_nối tới một máy_chủ , quét cổng , truyền_tải tập_tin , và hoạt_động như một backdoor .
Kiểm_tra thư_mục Start_Up của hệ_thống – hoàn_toàn bình_thường , không hề có một file nào gọi tới system 32.exe . Kiểm_tra hệ_thống System_Registry , tôi chợt mừng_húm vì cảm_giác mình khám_phá ra thêm một manh_mối , system32.exe đã được gọi khi máy khởi_động với khóa chuyển như sau : system32.exe - p 23985 - d - L - e cmd . exe .
Wow , kiểm_tra tiếp thử xem sao ! Tôi sử_dụng telnet vào localhost với port 23985 và kết_quả nhận được là một shell lệnh của hệ_thống Windows với dấu_nhắc C : \ & gt ; quen_thuộc .
Một bức tranh sơ_lược nhanh_chóng được phác_họa trong đầu tôi : hacker tấn_công vào máy trạm của nhân_viên K . để chiếm quyền điều_khiển . Sau đó dùng máy này tấn_công tiếp vào các máy trong trụ_sở chính và gửi email để “ xin tiền ” . Có_vẻ hợp logic nhưng vẫn có vài điểm chưa thuyết_phục . Đó là gì nhỉ ? Tôi mệt_mỏi thiếp đi và đành khám_phá câu trả_lời vào ngày_mai .
THANH_TRỰC
