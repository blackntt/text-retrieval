 Xâm_nhập thế_giới hacker , kỳ 3 : Lộ mặt
Một ngày mới bắt_đầu . Đây cũng là ngày thứ_năm tôi lần theo dấu_vết của kẻ giấu mặt . Tôi bắt_đầu lật lại những giả_thuyết của ngày hôm_qua và kiểm_tra chúng . Tay hacker này làm thế_nào để quản_lý từ xa máy của K . khi mà máy này được đặt dưới một lớp Firewall tích_hợp Router của CISCO ? Tất_cả những kết_nối từ Internet tới các cổng ( port ) không phải là port chuẩn sẽ bị tường lửa lọc và loại_bỏ ngay từ đầu .
Đó là một điểm vô_lý ! Hoặc những chứng_cứ này chỉ là hỏa_mù cho một mục_đích khác ? Phải_chăng K . mới chính là người đã tấn_công hệ_thống và dựng lên con backdoor netcat để đổ tội cho một tay hacker nào_đó ? Nếu_không phải K . là thủ_phạm thì làm thế_nào tay hacker đó cài_đặt được con netcat lên máy của K ? Vì rõ_ràng máy của K ko hề nằm trong bảng NAT của Router . Những câu_hỏi , giả_thuyết trái_ngược nhau cứ rối_beng lên trong đầu tôi .
Bắt_đầu sắp_xếp lại mọi thứ , tôi bắt_tay bằng System_Registry của hệ_thống . Tại_sao ? Ngày_giờ khởi tạo khóa trong Registry để chạy con backdoor kia khi hệ_thống khởi_động chính là ngày mà tên hacker đó làm_chủ hệ_thống ? Uhm , ngày 28 tháng 01 năm 2005 ! Tôi tiếp_tục bằng việc đọc system log của hệ_thống mặc_dù biết rằng một tay hacker " gà " nhất cũng sẽ xóa_bỏ dấu_vết của mình trên hệ_thống đã bị xâm_nhập . Nhưng mặc_kệ , cứ đọc đi , kinh_nghiệm cho thấy không nên bỏ_qua bất_cứ một chi_tiết nào dù là những chi_tiết nhỏ nhất .
Ngày 28 tháng 01 năm 2005 là ngày hệ_thống bị xâm_nhập , tôi bắt_đầu_từ đó . Đúng như tôi dự_đoán , system log đã được rửa sạch_sẽ không một_chút dấu_vết nào , còn lại có_thể nghi_ngờ ngoài trừ việc system log của nhiều ngày liên_tiếp giống nhau như anh_em sinh_đôi . Dễ hiểu thôi , đó chính là một system log giả mà hacker đã tạo ra để copy lên system log thực của hệ_thống . Bế_tắc ! ! ! Phải nói là tay hacker này khá thông_minh . Hắn quá cẩn_thận khi xóa sạch mọi thứ và chuẩn_bị cả một system log giả để đưa vào thay_thế cho system log thật đã bị xóa đi . Mọi đầu_mối lần ra nguyên_nhân bị xâm_nhập của hệ_thống có_vẻ như đã bị triệt_tiêu . Mọi thứ cứ như nằm dưới một màn sương mờ_ảo , vừa ẩn vừa hiện , vừa có_vẻ rõ_ràng nhưng lại vừa khiến cho tôi phải nghi_ngờ về tính xác_thực của chúng . Thực_sự , mọi thứ đã đi vào ngõ_cụt . Tôi cảm_thấy không còn đường để đi_nữa .
Nhận_diện
Một ngày sắp kết_thúc ! Đêm về khuya và tôi đi dạo sau một tách cafe nóng . Chân bước_đi nhưng trong lòng rối_bời vì những sự_kiện mà tôi đã thu_thập được . Ngồi xuống ghế và bắt_đầu thư_dãn , tôi nghĩ tới sự đổ_vỡ của cả hệ_thống của công_ty A . nếu_như không tìm được nguồn_gốc của cuộc tấn_công và ngăn_chặn chúng .
“ Đổ_vỡ ” ! Bất_chợt trong đầu tôi vang lên . “ Ừ , tại_sao không nhỉ ? Nếu tôi là tay hacker đó , thì tôi sẽ làm thế_nào để chiếm quyền cái máy trạm của K . trong khi không_thể kết_nối tới máy đó nếu_không được sự cho_phép của Router ? Đường nào sẽ có_thể tiếp_cận với máy của K . ? Tất_nhiên là qua những dịch_vụ truyền_thống Internet rồi ! ! ! ” . Tôi lập_tức quay trở_lại bàn_máy và phân_tích log của hệ_thống ở những phần đã bị crashed ( gãy đổ ) và mọi thứ nằm ngoài tưởng_tượng của tôi . Ngay trước khi System_Registry bị ghi vào khóa khởi_động netcat là sự đổ_vỡ hàng_loạt của trình_duyệt Internet_Explorer . À há ... . . Vấn_đề chính là đây ! Tôi bắt_đầu lên các trang bugtraq để tìm_kiếm thông_tin về lỗi bảo_mật của trình_duyệt IE .
Và rồi những gì cần có đã có . IE bị mắc một lỗi nghiêm_trọng cho_phép hacker khai_thác lỗi này từ xa thông_qua một trang_web và khi người dùng truy_cập tới trang_web này , một đoạn mã sẽ được tự_động tải xuống và thực_thi . Vậy_là đã rõ , “ hắn ” – kẻ “ xin tiền ” giấu mặt đã khai_thác lỗi của trình_duyệt IE để cài netcat lên máy của K . . Nhưng port 23985 hoàn_toàn không nằm trong bảng map NAT ( Network_Address_Translation ) của Router .
Vậy làm_sao hắn ta có_thể quản_lý từ xa được máy của K . nhỉ ? Hay_là lỗi của Router ? Tôi lập_tức gọi cho quản_trị mạng ở chi_nhánh Y để hỏi mật_khẩu truy_cập vào Router . Và một bất_ngờ nữa được tôi đón_nhận ko mấy thích_thú : tôi không_thể đăng_nhập vào Router bằng mật_khẩu mà quản_trị mạng của chi_nhánh Y đã đưa . Nhưng như_vậy là đã đủ . Tôi hài_lòng với những gì mình thu_nhận được trong ngày và quyết_định đi ngủ để chuẩn_bị cho ngày_mai .
Lộ mặt
Một ngày làm_việc bắt_đầu với các dữ_kiện đã được xâu_chuỗi và bức tranh của cuộc xâm_nhập đã hiện ra rõ_ràng hơn . Đầu_tiên , nhân_viên K . truy_cập vào một trang_web để tìm cách bẻ_khoá phần_mềm hiệu_chỉnh văn_bản trên máy của anh_ta . Trang_web này ngoài file bẻ_khoá phần_mềm ra , tác_giả đã hào_phóng tặng cho K . một con backdoor netcat và một đoạn mã lên máy của K . .
Đoạn mã thực_thi ngay_lập_tức một lệnh để gửi một email về cho hacker IP_WAN của hệ_thống mạng trong công_ty A . Hacker đã sử_dụng hình_thức brute force để bẻ mật_khẩu của Router sau đó sử_dụng nó để NAT port 23985 từ máy của K . ra ngoài . Nhân_viên quản_trị mạng của chi_nhánh Y đã mắc phải một sai_lầm nghiêm_trọng khi đặt một mật_khẩu quá đơn_giản và dễ đoán cho Router . Và kết_quả , điều đó đã tiếp_tay cho kẻ tấn_công . Sau khi xâm_nhập vào được máy của K . , hacker đã dùng máy này để tấn_công tiếp vào mạng của công_ty A . đặt tại trụ_sở chính . Tài_khoản VPN của K . đã được sử_dụng để kết_nối tới mạng tại trụ_sở chính . Và đó là lí_do tại_sao mà các máy_chủ tại trụ_sở chính bị hack khi mà hệ_thống máy_chủ đó hoàn_toàn nằm độc_lập với mạng Internet . Tôi kết_thúc một ngày với tách cafe tự thưởng cho mình sau khi đã có cái nhìn rõ_ràng hơn về cuộc tấn_công vào hệ_thống .
Ngày thứ_bảy . Tôi bắt_đầu tổng_kết về cuộc tấn_công và đề ra kế_hoạch khắc_phục lại toàn_bộ hệ_thống cho công_ty A . . Bắt_đầu bằng việc rà_soát lại toàn_bộ chính_sách bảo_mật ( security policy ) của công_ty và thay_đổi những điều chưa hợp_lý . Tất_cả các mật_khẩu của hệ_thống được đặt lại theo “ policy ” mới , khó đoán hơn , an_toàn hơn và tất_nhiên cũng khó nhớ hơn . Các máy trong hệ_thống máy_tính đều được cài_đặt trình quét virus và tường lửa cá_nhân để tránh những trường_hợp các hacker khai_thác lỗi của trình_duyệt cài_đặt các đoạn mã độc_hại . Các máy_chủ đã bị xâm_nhập được cài_đặt lại sau đó nâng_cấp các bản sửa lỗi nhanh ( hot fixes ) và các các bản sửa lỗi định_kì từ nhà_cung_cấp Microsoft ( services patch ) . Toàn_bộ dữ_liệu backup được phục_hồi lại từ băng_từ . Phải nói rằng rất may là chính_sách sao lưu_giữ liệu đã cứu cho công_ty A . một bàn thua trông thấy .
Sau những ngày mệt_mỏi , tôi tự thưởng cho mình một ngày thư_giãn và rút lại những bài_học cho mình .
1 . Không có gì là tuyệt_đối cả . Một hệ_thống chắc_chắn tưởng_chừng như không_thể xâm_phạm từ bên ngoài đã bị đánh sập trước một hacker từ bên ngoài .
2 . Hãy tôn_trọng địch_thủ của mình . Hệ_thống bị xâm_nhập và đội_ngũ kĩ_thuật của công_ty A . đã coi_thường lời cảnh_báo của tay hacker trong email đe_dọa của hắn . Nếu_như dữ_liệu khách_hàng không được backup hàng ngày , có_lẽ hậu_quả sẽ còn nghiêm_trọng hơn rất nhiều .
3 . Tôn_trọng chính_sách bảo_mật của công_ty đồng_thời tự bản_thân mỗi nhân_viên phải có ý_thức về những việc mình làm . Nếu_như nhân_viên K . không truy_cập vào các site cung_cấp crack ( vốn đầy_rẫy virus , trojans , backdoors , adware , spyware ... . ) thì có_thể hệ_thống máy_chủ của công_ty A . sẽ không bị xâm_nhập .
4 . Hãy đặt mình vào vị_trí của hacker để có những giả_thuyết hợp_lý để xử_lý các tình_huống .
5 . Luôn_luôn tỉnh_táo nhìn_nhận sự_việc ở nhiều góc_độ , tránh bị những cái bẫy của các hacker hạ đo_ván .
6 . Và cuối_cùng , một câu nói muôn thưở mà chúng_ta đã nghe nhắc nhiều lần : “ Bảo_mật thông_tin nằm trong ý_thức của mỗi con_người ” . Không_thể nói rằng , chúng_tôi có một chính_sách bảo_mật tốt , một hệ_điều_hành tốt , một firewall tốt , một máy_chủ mạnh và chúng_tôi sẽ đảm_bảo an_toàn thông_tin của mình . Đó là một trong những quan_niệm sai_lầm phổ_biến của các nhà quản_trị hệ_thống .
THANH_TRỰC
